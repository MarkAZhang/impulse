self.onmessage=function(a){var b=a.data.X,c=a.data.xc,d=a.data.gA,f=a.data.sx;a=a.data.Tq;for(var g=[],h=[],k=[],m={},C={},q={},r=0;r<b.length;r++)for(var p=b[r],u=p.length-1,s=0;s<p.length;s++){for(var H=p[s],B=!1,v=0;v<b.length;v++)r!=v&&fb(b[v],H)&&(B=!0);!B&&mb(0,H,d,f,a)&&(H.Me=r,H.tu=p.length,H.fe=s,h.push(H));g.push({Ad:p[s],Bd:p[u]});u=s}postMessage({kr:0.25});for(r=0;r<h.length;r++)for(m[r]={},s=0;s<r;s++)v=h[r],p=h[s],400==v.x*d&&350==v.y*d&&console.log("HERE"),v.Me!=p.Me||v.Me==p.Me&&(1==
Math.max(v.fe,p.fe)-Math.min(v.fe,p.fe)||0==Math.min(v.fe,p.fe)&&Math.max(v.fe,p.fe)==v.tu-1)?db(v,p,g)&&db(v,p,c)&&(k.push({Ad:v,Bd:p}),v=S(p,v),m[r][s]=v,m[s][r]=v):v.Me==p.Me&&!fb(b[v.Me],{x:(v.x+p.x)/2,y:(v.y+p.y)/2})&&(db(v,p,c)&&db(v,p,g))&&(k.push({Ad:v,Bd:p}),v=S(p,v),m[r][s]=v,m[s][r]=v);postMessage({kr:0.5});for(b=0;b<h.length;b++)for(p=Jd(m,b),C[b]={},r=0;r<b;r++)if(H=Kd(p,r),1==H.length)C[b][r]={path:null,Ic:null},C[r][b]={path:null,Ic:null};else{u=0;s=H[0];for(v=1;v<H.length;v++)u+=m[s][H[v]],
s=H[v];C[b][r]={path:H,Ic:u};C[r][b]={path:H.slice(0).reverse(),Ic:u}}postMessage({kr:0.75});b={};for(r=-150;r<f+150;r+=50)for(s=-150;s<a+150;s+=50){p=[];H=[{x:r/d,y:s/d},{x:r/d,y:(s+50)/d},{x:(r+50)/d,y:s/d},{x:(r+50)/d,y:(s+50)/d}];for(v=0;v<H.length;v++){var u=H[v],B=h,O=c,G=b;if(G.hasOwnProperty(u.x+" "+u.y))B=G[u.x+" "+u.y];else{for(var Z=[],T=0;T<B.length;T++)db(u,B[T],O)&&Z.push(T);B=G[u.x+" "+u.y]=Z}for(O=0;O<B.length;O++){G=!0;for(u=0;u<p.length;u++)if(p[u]==B[O]){G=!1;break}G&&p.push(B[O])}}q[r+
" "+s]=p}postMessage({lr:g,V:h,wt:k,vt:m,Dk:C,Kr:q})};function db(a,b,c){for(var d=0;d<c.length;d++)if(!(cb(a,c[d].Ad)||cb(a,c[d].Bd)||cb(b,c[d].Ad)||cb(b,c[d].Bd))&&eb(a,b,c[d].Ad,c[d].Bd))return!1;return!0}function fb(a,b){for(var c=a.length-1,d=!1,f=0;f<a.length;f++)(a[f].y<b.y&&a[c].y>=b.y||a[f].y>=b.y&&a[c].y<b.y)&&a[f].y!=a[c].y&&a[f].x+(b.y-a[f].y)/(a[c].y-a[f].y)*(a[c].x-a[f].x)<b.x&&(d=!d),c=f;return d}function S(a,b){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))}
function mb(a,b,c,d,f){c=c?c:1;return b.x>=a&&b.y>=a&&b.x<=d/c-a&&b.y<=f/c-a}function eb(a,b,c,d){b={x:b.x-a.x,y:b.y-a.y};d={x:d.x-c.x,y:d.y-c.y};a={x:c.x-a.x,y:c.y-a.y};c=gb(b,d);if(0==c&&0==gb(a,d))return!1;d=gb(a,d)/c;b=gb(a,b)/c;return 0<=d&&1>=d&&0<=b&&1>=b}cb=function(a,b){return a.x==b.x&&a.y==b.y};function gb(a,b){return a.x*b.y-a.y*b.x}
function Jd(a,b){var c={},d={};d[b]=0;var f=Qd.bB();f.push(b,0);for(var g,h,k,m,C,q;f;){g=f.pop();if(!g)break;h=g.value;g=g.kt;k=a[h]||{};for(var r in k){m=k[r];m=g+m;C=d[r];if((q="undefined"===typeof d[r])||C>m)d[r]=m,f.push(r,m),c[r]=h;if(void 0===r){f=null;break}}}return c}function Kd(a,b){for(var c=[],d=b;void 0!=d;)c.push(d),d=a[d];c.reverse();return c}
var Qd={bB:function(a){var b={};a=a||{};for(var c in Qd)b[c]=Qd[c];b.Bu=[];b.py=a.py||Qd.fA;return b},fA:function(a,b){return a.kt-b.kt},push:function(a,b){this.Bu.push({value:a,kt:b});this.Bu.sort(this.py)},pop:function(){return this.Bu.shift()}};